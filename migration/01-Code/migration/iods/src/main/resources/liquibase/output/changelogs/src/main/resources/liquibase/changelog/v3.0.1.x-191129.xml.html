<html><body><pre>
&lt;?xml version="1.1" encoding="UTF-8" standalone="no"?&gt;
&lt;databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.8.xsd"&gt;
    &lt;changeSet id="1574956800001-1" author="WangXun"&gt;
        &lt;comment&gt;SM_ProjectPageButtonConfig加入按钮配置&lt;/comment&gt;
        &lt;insert tableName="SM_ProjectPageButtonConfig"&gt;
            &lt;column name="ID" value="32"/&gt;
            &lt;column name="strProjectSysPowerCode" value="SM_Role"/&gt;
            &lt;column name="strButtonID" value="btnAdd_T"/&gt;
            &lt;column name="strButtonName" value="增加"/&gt;
            &lt;column name="strRemark" value="系统内置,勿删勿改"/&gt;
            &lt;column name="nPowerCodeType" valueNumeric="1"/&gt;
        &lt;/insert&gt;
        &lt;insert tableName="SM_ProjectPageButtonConfig"&gt;
            &lt;column name="ID" value="33"/&gt;
            &lt;column name="strProjectSysPowerCode" value="SM_Role"/&gt;
            &lt;column name="strButtonID" value="btnEdit_T"/&gt;
            &lt;column name="strButtonName" value="编辑"/&gt;
            &lt;column name="strRemark" value="系统内置,勿删勿改"/&gt;
            &lt;column name="nPowerCodeType" valueNumeric="1"/&gt;
        &lt;/insert&gt;
        &lt;insert tableName="SM_ProjectPageButtonConfig"&gt;
            &lt;column name="ID" value="34"/&gt;
            &lt;column name="strProjectSysPowerCode" value="SM_Role"/&gt;
            &lt;column name="strButtonID" value="btnDelete_T"/&gt;
            &lt;column name="strButtonName" value="删除"/&gt;
            &lt;column name="strRemark" value="系统内置,勿删勿改"/&gt;
            &lt;column name="nPowerCodeType" valueNumeric="1"/&gt;
        &lt;/insert&gt;
        &lt;insert tableName="SM_ProjectPageButtonConfig"&gt;
            &lt;column name="ID" value="35"/&gt;
            &lt;column name="strProjectSysPowerCode" value="SM_Role"/&gt;
            &lt;column name="strButtonID" value="btnCopy_T"/&gt;
            &lt;column name="strButtonName" value="复制"/&gt;
            &lt;column name="strRemark" value="系统内置,勿删勿改"/&gt;
            &lt;column name="nPowerCodeType" valueNumeric="1"/&gt;
        &lt;/insert&gt;
        &lt;insert tableName="SM_ProjectPageButtonConfig"&gt;
            &lt;column name="ID" value="36"/&gt;
            &lt;column name="strProjectSysPowerCode" value="SM_Role"/&gt;
            &lt;column name="strButtonID" value="btnAuthorize_T"/&gt;
            &lt;column name="strButtonName" value="授权"/&gt;
            &lt;column name="strRemark" value="系统内置,勿删勿改"/&gt;
            &lt;column name="nPowerCodeType" valueNumeric="1"/&gt;
        &lt;/insert&gt;
        &lt;insert tableName="SM_ProjectPageButtonConfig"&gt;
            &lt;column name="ID" value="37"/&gt;
            &lt;column name="strProjectSysPowerCode" value="SM_Role"/&gt;
            &lt;column name="strButtonID" value="btnAdd_M"/&gt;
            &lt;column name="strButtonName" value="增加"/&gt;
            &lt;column name="strRemark" value="系统内置,勿删勿改"/&gt;
            &lt;column name="nPowerCodeType" valueNumeric="0"/&gt;
        &lt;/insert&gt;
        &lt;insert tableName="SM_ProjectPageButtonConfig"&gt;
            &lt;column name="ID" value="38"/&gt;
            &lt;column name="strProjectSysPowerCode" value="SM_Role"/&gt;
            &lt;column name="strButtonID" value="btnDelete_M"/&gt;
            &lt;column name="strButtonName" value="删除"/&gt;
            &lt;column name="strRemark" value="系统内置,勿删勿改"/&gt;
            &lt;column name="nPowerCodeType" valueNumeric="0"/&gt;
        &lt;/insert&gt;
        &lt;insert tableName="SM_ProjectPageButtonConfig"&gt;
            &lt;column name="ID" value="39"/&gt;
            &lt;column name="strProjectSysPowerCode" value="SM_Role"/&gt;
            &lt;column name="strButtonID" value="btnAuthorize_M"/&gt;
            &lt;column name="strButtonName" value="授权"/&gt;
            &lt;column name="strRemark" value="系统内置,勿删勿改"/&gt;
            &lt;column name="nPowerCodeType" valueNumeric="0"/&gt;
        &lt;/insert&gt;
        &lt;rollback&gt;
            &lt;delete tableName="SM_ProjectPageButtonConfig"&gt;
                &lt;where&gt;ID=39&lt;/where&gt;
            &lt;/delete&gt;
            &lt;delete tableName="SM_ProjectPageButtonConfig"&gt;
                &lt;where&gt;ID=38&lt;/where&gt;
            &lt;/delete&gt;
            &lt;delete tableName="SM_ProjectPageButtonConfig"&gt;
                &lt;where&gt;ID=37&lt;/where&gt;
            &lt;/delete&gt;
            &lt;delete tableName="SM_ProjectPageButtonConfig"&gt;
                &lt;where&gt;ID=36&lt;/where&gt;
            &lt;/delete&gt;
            &lt;delete tableName="SM_ProjectPageButtonConfig"&gt;
                &lt;where&gt;ID=35&lt;/where&gt;
            &lt;/delete&gt;
            &lt;delete tableName="SM_ProjectPageButtonConfig"&gt;
                &lt;where&gt;ID=34&lt;/where&gt;
            &lt;/delete&gt;
            &lt;delete tableName="SM_ProjectPageButtonConfig"&gt;
                &lt;where&gt;ID=33&lt;/where&gt;
            &lt;/delete&gt;
            &lt;delete tableName="SM_ProjectPageButtonConfig"&gt;
                &lt;where&gt;ID=32&lt;/where&gt;
            &lt;/delete&gt;
        &lt;/rollback&gt;
    &lt;/changeSet&gt;
    &lt;changeSet id="1574956800001-2" author="WangXun"&gt;
        &lt;comment&gt;修改视图:V_SM_RoleSysPower和V_SM_PersonSysPower&lt;/comment&gt;
        &lt;createView viewName="V_SM_RoleSysPower" replaceIfExists="true" &gt;
            SELECT
            a.ID,
            a.RoleCode,
            a.SystemResourceDtlCode,
            a.PageButtonConfigID,
            b.strButtonID AS ButtonID,
            b.strButtonName AS ButtonName,
            b.nPowerCodeType,
            '1' AS IsEnable
            FROM
            SM_RoleSysPower AS a
            LEFT OUTER JOIN SM_ProjectPageButtonConfig AS b ON a.PageButtonConfigID = b.ID
        &lt;/createView&gt;
        &lt;rollback&gt;
            &lt;createView viewName="V_SM_RoleSysPower" replaceIfExists="true"&gt;
                SELECT
                a.RoleCode,
                a.IsEnable,
                b.ButtonID,
                b.ButtonName,
                b.SystemResourceDtlCode,
                b.IsSysMenu
                FROM
                SM_RoleSysPower AS a
                LEFT OUTER JOIN SM_PageButtonConfig AS b ON a.PageButtonConfigID = b.ID
            &lt;/createView&gt;
        &lt;/rollback&gt;
    &lt;/changeSet&gt;
    &lt;changeSet id="1574956800001-3" author="WangXun"&gt;
        &lt;createView viewName="V_SM_PersonSysPower" replaceIfExists="true" &gt;
            SELECT
            a.ID,
            a.SystemResourceDtlCode,
            a.PageButtonConfigID,
            b.PersonCode,
            c.strButtonID AS ButtonID,
            c.strButtonName AS ButtonName,
            c.nPowerCodeType,
            '0' AS IsEnable
            FROM
            SM_RoleSysPower AS a
            LEFT JOIN SM_PersonRole_Rel AS b ON a.RoleCode = b.RoleCode
            LEFT JOIN SM_ProjectPageButtonConfig AS c ON a.PageButtonConfigID = c.ID UNION
            SELECT
            a.ID,
            a.SystemResourceDtlCode,
            a.PageButtonConfigID,
            a.PersonCode,
            b.strButtonID AS ButtonID,
            b.strButtonName AS ButtonName,
            b.nPowerCodeType,
            '1' AS IsEnable
            FROM
            SM_PersonSysPower AS a
            LEFT JOIN SM_ProjectPageButtonConfig AS b ON a.PageButtonConfigID = b.ID
        &lt;/createView&gt;
        &lt;rollback&gt;
            &lt;createView fullDefinition="false" viewName="V_SM_PersonSysPower" replaceIfExists="true"&gt;
                SELECT
                a.ID AS Code,
                b.PersonCode,
                a.IsEnable,
                c.ButtonID,
                c.ButtonName,
                c.SystemResourceDtlCode,
                c.IsSysMenu,
                a.PageButtonConfigID,
                '0' AS strIsEnable
                FROM
                SM_RoleSysPower AS a
                LEFT JOIN SM_PersonRole_Rel AS b ON a.RoleCode = b.RoleCode
                LEFT JOIN SM_PageButtonConfig AS c ON a.PageButtonConfigID = c.ID UNION
                SELECT
                a.ID AS Code,
                a.PersonCode,
                a.IsEnable,
                b.ButtonID,
                b.ButtonName,
                b.SystemResourceDtlCode,
                b.IsSysMenu,
                a.PageButtonConfigID,
                '1' AS strIsEnable
                FROM
                SM_PersonSysPower AS a
                LEFT JOIN SM_PageButtonConfig AS b ON a.PageButtonConfigID = b.ID
            &lt;/createView&gt;
        &lt;/rollback&gt;
    &lt;/changeSet&gt;
    &lt;changeSet id="1574956800001-4" author="WangXun"&gt;
        &lt;comment&gt;更新数据:SM_SystemResourceDtl&lt;/comment&gt;
        &lt;update tableName="SM_SystemResourceDtl" &gt;
            &lt;column name="Title" value="角色权限组态" /&gt;
            &lt;where&gt;
                Code = 'SM_Role'
            &lt;/where&gt;
        &lt;/update&gt;
        &lt;update tableName="SM_SystemResourceDtl" &gt;
            &lt;column name="Title" value="角色权限组态" /&gt;
            &lt;where&gt;
                Code = 'SM_Role'
            &lt;/where&gt;
        &lt;/update&gt;
        &lt;rollback&gt;
            &lt;update tableName="SM_SystemResourceDtl" &gt;
                &lt;column name="Title" value="权限组态" /&gt;
                &lt;where&gt;
                    Code = 'SM_Role'
                &lt;/where&gt;
            &lt;/update&gt;
        &lt;/rollback&gt;
    &lt;/changeSet&gt;
    &lt;changeSet id="1574956800001-5" author="WangXun"&gt;
        &lt;comment&gt;清空表SM_PersonSysPower脏数据&lt;/comment&gt;
        &lt;delete tableName="SM_PersonSysPower" /&gt;
        &lt;rollback/&gt;
    &lt;/changeSet&gt;
    &lt;changeSet id="v3.0.2.0" author="WangXun"&gt;
        &lt;tagDatabase tag="v3.0.2.0"/&gt;
    &lt;/changeSet&gt;
&lt;/databaseChangeLog&gt;
</pre></body></html>